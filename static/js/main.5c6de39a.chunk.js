(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{22:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var c=n(11),o=n(1),a=n.n(o),r=(n(20),n(21),n(22),n(9)),s=n(8),i=n(2),l=n(4),u=n.n(l),d=n(5),j=n(3),f=n.n(j),b="https://mate.academy/students-api";function m(e){return new Promise((function(t){setTimeout(t,e)}))}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:t};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),m(300).then((function(){return fetch(b+e,c)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var h,O=function(e){return p(e)},v=function(e,t){return p(e,"POST",t)},x=function(e,t){return p(e,"PATCH",t)},g=function(e){return p(e,"DELETE")},N=function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.name,e.abrupt("return",v("/users",{email:n,name:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=n(0),C=function(e){var t=e.onLogin,n=Object(o.useState)(""),c=Object(i.a)(n,2),a=c[0],r=c[1],s=Object(o.useState)(""),l=Object(i.a)(s,2),j=l[0],b=l[1],m=Object(o.useState)(!1),p=Object(i.a)(m,2),h=p[0],O=p[1],v=Object(o.useState)(!1),x=Object(i.a)(v,2),g=x[0],C=x[1],_=Object(o.useState)(""),S=Object(i.a)(_,2),k=S[0],A=S[1],E=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(o.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(c){}}),[]);var w=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(a);case 2:(t=e.sent)?E(t):O(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),A(""),C(!0),e.prev=3,!h){e.next=9;break}return e.next=7,y({name:j,email:a}).then(E);case 7:e.next=11;break;case 9:return e.next=11,w();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),A("Something went wrtong");case 16:return e.prev=16,C(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(T.jsxs)("form",{onSubmit:L,className:"box mt-5",children:[Object(T.jsx)("h1",{className:"title is-3",children:h?"You need to register":"Log in to open todos"}),Object(T.jsxs)("div",{className:"field",children:[Object(T.jsxs)("label",{className:"label",htmlFor:"user-email",children:["Email",Object(T.jsxs)("div",{className:f()("control has-icons-left",{"is-loading":g}),children:[Object(T.jsx)("input",{type:"email",name:"user-email",id:"user-email",className:f()("input",{"is-danger":!h&&k}),placeholder:"Enter your email",disabled:g||h,value:a,required:!0,onChange:function(e){return r(e.target.value)}}),Object(T.jsx)("span",{className:"icon is-small is-left",children:Object(T.jsx)("i",{className:"fas fa-envelope"})})]})]}),!h&&k&&Object(T.jsx)("p",{className:"help is-danger",children:k})]}),h&&Object(T.jsxs)("div",{className:"field",children:[Object(T.jsxs)("label",{className:"label",htmlFor:"user-name",children:["Your Name",Object(T.jsxs)("div",{className:f()("control has-icons-left",{"is-loading":g}),children:[Object(T.jsx)("input",{type:"text",id:"user-name",className:f()("input",{"is-danger":h&&k}),placeholder:"Enter your name",required:!0,minLength:4,disabled:g,value:j,onChange:function(e){return b(e.target.value)}}),Object(T.jsx)("span",{className:"icon is-small is-left",children:Object(T.jsx)("i",{className:"fas fa-user"})})]})]}),h&&k&&Object(T.jsx)("p",{className:"help is-danger",children:k})]}),Object(T.jsx)("div",{className:"field",children:Object(T.jsx)("button",{type:"submit",className:f()("button is-primary",{"is-loading":g}),children:h?"Register":"Login"})})]})},_=a.a.createContext(null),S=function(e){var t=e.children,n=Object(o.useState)(null),c=Object(i.a)(n,2),a=c[0],r=c[1];return a?Object(T.jsx)(_.Provider,{value:a,children:t}):Object(T.jsx)(C,{onLogin:r})};!function(e){e.All="All",e.Active="Active",e.Completed="Completed"}(h||(h={}));var k,A=a.a.memo((function(e){var t=e.todo,n=e.onDelete,c=e.isAdding,a=e.clearCompleted,r=e.changeTodo,s=e.processedTodo,l=Object(o.useState)(!1),u=Object(i.a)(l,2),d=u[0],j=u[1],b=Object(o.useState)(""),m=Object(i.a)(b,2),p=m[0],h=m[1],O=t.completed,v=t.title,x=t.id,g=function(){j(!1),p?p&&p!==v&&r(x,p,!1):n(x)};return Object(o.useEffect)((function(){a&&O&&n(x)}),[a,O]),Object(T.jsxs)("div",{"data-cy":"Todo",className:f()("todo",{completed:O}),children:[Object(T.jsx)("label",{className:"todo__status-label",htmlFor:"todo_status",children:Object(T.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:O,id:"todo_status",onChange:function(){return r(x,v)}})}),d?Object(T.jsx)("form",{onSubmit:g,children:Object(T.jsx)("input",{"data-cy":"TodoTitle",className:"todo__title-field",type:"text",value:p,onChange:function(e){return h(e.target.value)},onBlur:g,onKeyUp:function(e){"Escape"===e.key&&j(!1)}})}):Object(T.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){j(!0),h(v)},children:v}),d||Object(T.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){return n(x)},children:"\xd7"}),Object(T.jsxs)("div",{"data-cy":"TodoLoader",className:f()("modal overlay",{"is-active":s.includes(x)||c}),children:[Object(T.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(T.jsx)("div",{className:"loader"})]})]})})),E=a.a.memo((function(e){var t=e.todos,n=e.onDelete,c=e.filterStatus,a=e.clearCompleted,r=e.changeTodo,s=e.processedTodo,i=Object(o.useMemo)((function(){switch(c){case h.Active:return t.filter((function(e){return!e.completed}));case h.Completed:return t.filter((function(e){return e.completed}));default:return t}}),[c,t]);return Object(T.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:i.map((function(e){return Object(T.jsx)(A,{todo:e,onDelete:n,clearCompleted:a,changeTodo:r,processedTodo:s},e.id)}))})})),w=function(e){var t=e.errorMessage,n=e.onClose;return Object(o.useEffect)((function(){var e=setTimeout((function(){return n("")}),3e3);return function(){return clearTimeout(e)}}),[t]),Object(T.jsxs)("div",{"data-cy":"ErrorNotification",className:"notification is-danger is-light has-text-weight-normal",hidden:""===t,children:[Object(T.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){return n("")}}),t]})},L=function(e,t,n){return x("/todos/".concat(e),{title:t,completed:n})},I=a.a.memo((function(e){var t=e.isAdding,n=e.todosLength,c=e.onSubmit,a=e.title,r=e.setTitle,s=e.onToggle,i=e.completedTodos,l=Object(o.useRef)(null);return Object(o.useEffect)((function(){l.current&&l.current.focus()}),[]),Object(T.jsxs)("header",{className:"todoapp__header",children:[!!n&&Object(T.jsx)("button",{"data-cy":"ToggleAllButton",type:"button","aria-label":"ToggleAllButton",className:f()("todoapp__toggle-all",{active:n===i}),onClick:s}),Object(T.jsx)("form",{onSubmit:c,children:Object(T.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:l,value:a,onChange:function(e){return r(e.target.value)},className:"todoapp__new-todo",placeholder:"What needs to be done?",disabled:t})})]})})),D=a.a.memo((function(e){var t=e.onStatusChange,n=e.status,c=e.activeTodos,a=e.completedTodos,r=e.onClear;return Object(o.useEffect)((function(){a||r(!1)}),[a]),Object(T.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(T.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(c," items left")}),Object(T.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(T.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:f()("filter__link",{selected:n===h.All}),onClick:function(){return t(h.All)},children:"All"}),Object(T.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:f()("filter__link",{selected:n===h.Active}),onClick:function(){return t(h.Active)},children:"Active"}),Object(T.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:f()("filter__link",{selected:n===h.Completed}),onClick:function(){return t(h.Completed)},children:"Completed"})]}),Object(T.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:"todoapp__clear-completed",disabled:!a,onClick:function(){return r(!0)},children:"Clear completed"})]})}));!function(e){e.TodosWereNotLoaded="Cannot load todos list",e.TitleIsEmpty="Title can't be empty",e.TodoIsNotAdded="Unable to add a todo",e.TodoIsNotDeleted="Cannot delete todo",e.TodoIsNotUpdates="Unable to update a todo"}(k||(k={}));var F=function(){var e=Object(o.useContext)(_),t=Object(o.useState)([]),n=Object(i.a)(t,2),c=n[0],a=n[1],l=Object(o.useState)(""),u=Object(i.a)(l,2),d=u[0],j=u[1],f=Object(o.useState)(!1),b=Object(i.a)(f,2),m=b[0],p=b[1],x=Object(o.useState)(null),N=Object(i.a)(x,2),y=N[0],C=N[1],S=Object(o.useState)(""),F=Object(i.a)(S,2),B=F[0],M=F[1],U=Object(o.useState)(h.All),J=Object(i.a)(U,2),P=J[0],R=J[1],W=Object(o.useState)(!1),q=Object(i.a)(W,2),H=q[0],Y=q[1],G=Object(o.useState)([0]),K=Object(i.a)(G,2),z=K[0],Q=K[1],V=Object(o.useMemo)((function(){return c.filter((function(e){return!e.completed})).length}),[c]),X=Object(o.useMemo)((function(){return c.length-V}),[V]),Z=Object(o.useMemo)((function(){return c.length}),[c]);Object(o.useEffect)((function(){var t;e&&(t=e.id,O("/todos?userId=".concat(t))).then(a).catch((function(){return j(k.TodosWereNotLoaded)}))}),[e]);var $=function(e){return Q((function(t){return[].concat(Object(s.a)(t),[e])})),(t=e,g("/todos/".concat(t))).then((function(){a((function(t){return t.filter((function(t){return t.id!==e}))}))})).catch((function(){return j(k.TodoIsNotDeleted)})).finally((function(){return Q((function(t){return t.filter((function(t){return t!==e}))}))}));var t},ee=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Q((function(t){return[].concat(Object(s.a)(t),[e])})),L(e,t).then((function(){a((function(c){return c.map((function(c){return c.id===e?Object(r.a)(Object(r.a)({},c),{},{title:t,completed:n?!c.completed:c.completed}):c}))}))})).catch((function(){return j(k.TodoIsNotUpdates)})).finally((function(){return Q((function(t){return t.filter((function(t){return t!==e}))}))}))};return Object(T.jsxs)("div",{className:"todoapp",children:[Object(T.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(T.jsxs)("div",{className:"todoapp__content",children:[Object(T.jsx)(I,{isAdding:m,todosLength:Z,onSubmit:function(t){t.preventDefault(),B.trim()?e&&(p(!0),C({id:0,userId:e.id,title:B,completed:!1}),function(e,t){return v("/todos",{title:e,userId:t,completed:arguments.length>2&&void 0!==arguments[2]&&arguments[2]})}(B,null===e||void 0===e?void 0:e.id).then((function(e){a((function(t){return[].concat(Object(s.a)(t),[e])})),M("")})).catch((function(){return j(k.TodoIsNotAdded)})).finally((function(){p(!1),C(null),M("")}))):j(k.TitleIsEmpty)},title:B,setTitle:M,onToggle:function(){var e=Z===X;c.forEach((function(t){var n=t.id,c=t.title;t.completed===e&&ee(n,c)}))},completedTodos:X}),Object(T.jsx)(E,{todos:c,onDelete:$,filterStatus:P,clearCompleted:H,changeTodo:ee,processedTodo:z}),y&&Object(T.jsx)(A,{todo:y,onDelete:$,isAdding:m,clearCompleted:H,changeTodo:ee,processedTodo:z}),!!Z&&Object(T.jsx)(D,{onStatusChange:R,status:P,activeTodos:V,completedTodos:X,onClear:Y})]}),Object(T.jsx)(w,{errorMessage:d,onClose:j})]})},B=function(){return Object(T.jsx)(S,{children:Object(T.jsx)(F,{})})};Object(c.createRoot)(document.getElementById("root")).render(Object(T.jsx)(B,{}))}},[[25,1,2]]]);
//# sourceMappingURL=main.5c6de39a.chunk.js.map